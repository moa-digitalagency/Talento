{% extends 'base.html' %}

{% block title %}Modifier - {{ user.full_name }}{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 py-8 px-4">
    <div class="max-w-6xl mx-auto">
        
        <!-- En-t√™te -->
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-4xl font-bold text-indigo-600">‚úèÔ∏è Modifier le Profil</h1>
            <a href="{{ url_for('admin.user_detail', user_id=user.id) }}" 
               class="btn-secondary px-6">
                ‚Üê Retour
            </a>
        </div>

        <form method="POST" class="space-y-6">
            
            <!-- Informations personnelles -->
            <div class="section-blue p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üë§</span>
                    <span>Informations personnelles</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Pr√©nom *</label>
                        <input type="text" name="first_name" value="{{ user.first_name }}" required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Nom *</label>
                        <input type="text" name="last_name" value="{{ user.last_name }}" required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Email *</label>
                        <input type="email" name="email" value="{{ user.email }}" required
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Date de naissance</label>
                        <input type="date" name="date_of_birth" value="{{ user.date_of_birth.strftime('%Y-%m-%d') if user.date_of_birth else '' }}"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Genre</label>
                        <select name="gender" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                            <option value="">Non pr√©cis√©</option>
                            <option value="M" {% if user.gender == 'M' %}selected{% endif %}>Homme</option>
                            <option value="F" {% if user.gender == 'F' %}selected{% endif %}>Femme</option>
                            <option value="N" {% if user.gender == 'N' %}selected{% endif %}>Autre</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Code unique</label>
                        <input type="text" value="{{ user.formatted_code }}" disabled
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed font-mono">
                    </div>
                </div>
            </div>

            <!-- Contact -->
            <div class="section-green p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üìû</span>
                    <span>Contact</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">T√©l√©phone</label>
                        <input type="tel" name="phone" value="{{ user.phone or '' }}"
                               placeholder="+212 6XX XXX XXX"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">WhatsApp</label>
                        <input type="tel" name="whatsapp" value="{{ user.whatsapp or '' }}"
                               placeholder="+212 6XX XXX XXX"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-gray-700 font-semibold mb-2">Adresse</label>
                        <input type="text" name="address" value="{{ user.address or '' }}"
                               placeholder="Adresse compl√®te"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500">
                    </div>
                </div>
            </div>

            <!-- Localisation -->
            <div class="section-purple p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üåç</span>
                    <span>Localisation</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Pays d'origine</label>
                        <select name="country_id" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                            <option value="">S√©lectionner...</option>
                            {% for country in countries %}
                            <option value="{{ country.id }}" {% if user.country_id == country.id %}selected{% endif %}>
                                {{ country.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Ville au Maroc</label>
                        <select name="city_id" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                            <option value="">S√©lectionner...</option>
                            {% for city in cities %}
                            <option value="{{ city.id }}" {% if user.city_id == city.id %}selected{% endif %}>
                                {{ city.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <!-- Profil professionnel -->
            <div class="section-orange p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üíº</span>
                    <span>Profil professionnel</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Disponibilit√©</label>
                        <select name="availability" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-orange-500">
                            <option value="">S√©lectionner...</option>
                            <option value="Temps plein" {% if user.availability == 'Temps plein' %}selected{% endif %}>‚è∞ Temps plein</option>
                            <option value="Temps partiel" {% if user.availability == 'Temps partiel' %}selected{% endif %}>üïê Temps partiel</option>
                            <option value="Mi-temps" {% if user.availability == 'Mi-temps' %}selected{% endif %}>‚è≥ Mi-temps</option>
                            <option value="Flexible" {% if user.availability == 'Flexible' %}selected{% endif %}>üîÑ Flexible</option>
                            <option value="Occasionnel" {% if user.availability == 'Occasionnel' %}selected{% endif %}>üìÖ Occasionnel</option>
                            <option value="Indisponible" {% if user.availability == 'Indisponible' %}selected{% endif %}>‚ùå Indisponible</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Mode de travail</label>
                        <select name="work_mode" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-orange-500">
                            <option value="">S√©lectionner...</option>
                            <option value="Sur site" {% if user.work_mode == 'Sur site' %}selected{% endif %}>üè¢ Sur site</option>
                            <option value="√Ä distance" {% if user.work_mode == '√Ä distance' %}selected{% endif %}>üíª √Ä distance</option>
                            <option value="Hybride" {% if user.work_mode == 'Hybride' %}selected{% endif %}>üîÑ Hybride</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Fourchette tarifaire</label>
                        <input type="text" name="rate_range" value="{{ user.rate_range or '' }}"
                               placeholder="Ex: 500-1000 MAD/jour"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-orange-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Ann√©es d'exp√©rience</label>
                        <input type="number" name="years_experience" value="{{ user.years_experience or '' }}" min="0" max="50"
                               placeholder="Nombre d'ann√©es"
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-orange-500">
                    </div>
                </div>
            </div>

            <!-- Talents et comp√©tences -->
            <div class="section-indigo p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üéØ</span>
                    <span>Talents et comp√©tences</span>
                </h2>
                
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    {% for talent in all_talents %}
                    <label class="flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-indigo-50 cursor-pointer transition-all">
                        <input type="checkbox" name="talents" value="{{ talent.id }}" 
                               {% if talent.id in user_talent_ids %}checked{% endif %}
                               class="w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        <span class="text-2xl">{{ talent.emoji }}</span>
                        <span class="text-sm font-semibold text-gray-700">{{ talent.name }}</span>
                    </label>
                    {% endfor %}
                </div>
            </div>

            <!-- Biographie et Portfolio -->
            <div class="section-cyan p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üìù</span>
                    <span>Biographie et Portfolio</span>
                </h2>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Biographie</label>
                        <textarea name="bio" rows="5"
                                  placeholder="D√©crivez votre parcours et vos comp√©tences..."
                                  class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-cyan-500">{{ user.bio or '' }}</textarea>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Portfolio URL</label>
                        <input type="url" name="portfolio_url" value="{{ user.portfolio_url or '' }}"
                               placeholder="https://..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-cyan-500">
                    </div>
                </div>
            </div>

            <!-- R√©seaux sociaux -->
            <div class="section-pink p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üåê</span>
                    <span>R√©seaux sociaux</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">LinkedIn</label>
                        <input type="url" name="linkedin" value="{{ user.linkedin or '' }}"
                               placeholder="https://linkedin.com/in/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Instagram</label>
                        <input type="url" name="instagram" value="{{ user.instagram or '' }}"
                               placeholder="https://instagram.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Twitter</label>
                        <input type="url" name="twitter" value="{{ user.twitter or '' }}"
                               placeholder="https://twitter.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Facebook</label>
                        <input type="url" name="facebook" value="{{ user.facebook or '' }}"
                               placeholder="https://facebook.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">GitHub</label>
                        <input type="url" name="github" value="{{ user.github or '' }}"
                               placeholder="https://github.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Behance</label>
                        <input type="url" name="behance" value="{{ user.behance or '' }}"
                               placeholder="https://behance.net/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Dribbble</label>
                        <input type="url" name="dribbble" value="{{ user.dribbble or '' }}"
                               placeholder="https://dribbble.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">YouTube</label>
                        <input type="url" name="youtube" value="{{ user.youtube or '' }}"
                               placeholder="https://youtube.com/..."
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pink-500">
                    </div>
                </div>
            </div>

            <!-- Boutons d'action -->
            <div class="flex gap-4">
                <button type="submit" class="btn-primary flex-1 py-4 text-lg font-semibold">
                    üíæ Enregistrer les modifications
                </button>
                <a href="{{ url_for('admin.user_detail', user_id=user.id) }}" 
                   class="btn-secondary px-8 py-4 text-lg font-semibold">
                    ‚ùå Annuler
                </a>
            </div>

        </form>

    </div>
</div>
{% endblock %}
